## Redux 란?

---

- 상태관리 라이브러리

<br>
<br>

## 왜 Redux를 사용하는가?

- 컴포넌트의 상태 관련 로직들을 다른 파일들로 분리시켜 효율적으로 관리 가능
- 글로벌 상태 관리 가능

⁉️ redux는 리액트에서 사용하기 위해 만들어진 라이브러리이지만, javascript 혹은 Angular 와 같은 다른 프레임워크에서도 사용이 가능하다.

- contextApi 와 매우 비슷하다.

<br>
<br>

## Redux vs Context Api

크게 3가지 차이점이 있다.

<br>

### 1. 미들웨어

리덕스에는 미들웨어라는 개념이 존재한다. 미들웨어를 사용하면 액션 객체가 리듀서에서 처리되기 전에 원하는 작업들을 수행할 수 있다. 주로 비동기 작업을 처리할 때 많이 사용된다.

예시)

- 특정 조건에 따라 액션이 무시되게 만들 수 있습니다.
- 액션을 콘솔에 출력하거나, 서버쪽에 로깅을 할 수 있습니다.
- 액션이 디스패치 됐을 때 이를 수정해서 리듀서에게 전달되도록 할 수 있습니다.
- 특정 액션이 발생했을 때 이에 기반하여 다른 액션이 발생되도록 할 수 있습니다.
- 특정 액션이 발생했을 때 특정 자바스크립트 함수를 실행시킬 수 있습니다.

<br>

### 2. 유용한 함수와, Hooks

Context API 와 useReducer를 사용할 때, Context, provider, 커스텀 Hook을 만들어 사용했다 .

리덕스에서는 connect 함수를 사용하면, 리덕스의 상태 또는 액션 생성 함수를 컴포넌트의 props를 받아올 수 있다.

리덕스 훅 예시 ) `useSelector`, `useDispatch`, `useStore`

훅에 대한 공식문서 설명) [https://react-redux.js.org/api/hooks](https://react-redux.js.org/api/hooks)

이때! redux 의 connect 함수와 useSelector 함수는 실제 상태가 바뀔때만 컴포넌트가 리랜더링 된다

Context API를 사용할 때에는 최적화가 자동으로 이루어지지 않기 때문에, context가 지니고 있는 상태가 바뀌면 해당 Context의 Provider 내부 컴포넌트들이 모두 리렌더링 된다.

<br>

### 3. 하나의 커다란 상태

Context API : 일반적으로 기능별로 Context를 만들오 사용한다.

Redux: 글로벌 상태를 하나의 커다란 상태 객체에 넣어서 사용하는 것이 필수!

<br>
<br>

## Redux 언제 쓰는게 좋은가?

1. 프로젝트의 규모가 큰가?
   - Yes: 리덕스
   - No: Context API
2. 비동기 작업을 자주 하게 되는가?
   - Yes: 리덕스
   - No: Context API
3. 리덕스를 배워보니까 사용하는게 편한가?
   - Yes: 리덕스
   - No: Context API 또는 MobX

<br> 
<br> 
<br>

## 리덕스의 기본 키워드 알아보기

> 액션

### 액션

저장소로 보내는 데이터 묶음. 상태에 어떠한 변화가 필요할 때, 액션을 발생시킨다. 하나의 객체로 표현된다.

`store.dispatsh()`로 이들을 전송한다.

예를들어 새 할일의 추가를 나타내는 액션의 코드는 다음과 같다. `type`의 속성을 반드시 가져야한다.

```jsx
{
  type: "ADD_TODO",
  data: {
    id: 0,
    text: "리덕스 배우기"
  }
}
```

<br>

### 액션 생산자, 액션 생성 함수

액션을 만드는 함수이다. 파라미터를 받아와서 액션 객테 형태로 만들어준다.

액션 생산자 코드 예시)

```jsx
function addTodo(text) {
  return {
    type: ADD_TODO,
    text,
  };
}
```

액션 함수가 필수적이진 않지만, 매번 액션 객체를 생성시키지 않고 더욱 쉽게 액션을 발생시킬 수 있다.

<br> 
<br>

> 리듀서

액션은 `무언가 일어난다`. 라는 사실을 기술하지만, `어떻게 바뀌는지` 특정하지는 않는다. 이것이 바로 리듀서가 할 일

### 리듀서

리듀서는 변화를 일으키는 함수이다. 2가지의 파라미터를 받아온다.

리듀서는 현재의 상태와 전달 받은 액션을 참고하여 새로운 상태를 만들어 반환한다. `useReducer`를 사용할 때의 리듀서와 똑같은 형태를 가지고 있다.

```jsx
function reducer(state, action) {
  // 상태 업데이트 로직
  return alteredState;
}
```

카운더를 위한 리듀서 코드 예시)

```jsx
function counter(state, action) {
  switch (action.type) {
    case "INCREASE":
      return state + 1;
    case "DECREASE":
      return state - 1;
    default:
      return state;
  }
}
```

<br> 
<br>

> 스토어

리덕스에서는 한 애플리케이션 강 하나의 스토어를 만들게 된다. 스토어 안에는 현재의 앱 상태, 리듀서가 들어있고, 내장함수들이 있다.

저장소는 아래와 같은 일들을 해야한다.

- 애플리케이션의 상태를 저장하고;
- `getState()`를 통해 상태에 접근하게 하고;
- `dispatch(action)`를 통해 상태를 수정할 수 있게 하고;
- `subscribe(listener)`를 통해 리스너를 등록한다.

> 데이터 흐름

### 디스패치

스토어의 내장함수 중 하나. 액션을 발생시키는 함수. dispatch 라는 함수에는 액션을 파라미터로 전달한다. `dispatch(action)`

### 구독

스토더의 내장함수 중 하나. subscribe 함수에 특정 함수를 전달해주면, 액션이 디스패치 되었을 때 마다 전달해준 함수가 호출된다. 이 함수를 직접 사용하는 일은 별로 없다!

react-redux 라는 라이브러리에서 제공하는 connect 함수 또는 useSeletor Hook 를 사용하여 리덕스 스토어의 상태에 구독한다.

<br> 
<br>

## 리덕스의 3가지 원칙

리덕스를 프로젝트에서 사용할 때 꼭 지켜야하는 3가지의 규칙이 있다.

<br>

### 1. 하나의 애플리케이션 안에는 하나의 스토어가 있다.

애플리케이션의 모든 상태는 하나의 저장소 안에 하나의 트리구조로 저장된다.

이를 통해 범용적인 애플리케이션(universal application, 하나의 코드 베이스로 다양한 환경에서 실행 가능한 코드)을 만들기 쉽게 만들 수 있다. 또한 하나의 상태 트리만을 가지고 있기 때문에 디버깅에도 용이하며, 실행취소/다시실행(undo/redo)을 손쉽게 구현할 수 있습니다.

<br>

### 2. 상태는 읽기 전용이다

상태를 변화시키는 유일한 방법은 액션객체를 전달하는 방법 뿐이다.

기존의 상태는 건드리지 않고 새로운 상태를 생성하여 업데이트 해주는 방식으로 해주면( Object.assign 을 사용하거나 spread 연산자 (...) 를 사용), 나중에 개발자 도구를 통해 뒤로 돌릴 수도 있고, 앞으로 돌릴 수도 있다.

리덕스에서 불변성을 유지해야하는 이유는 내부적으로 데이터가 변경 되는 것을 감지하기 위해서 shallow equailty 검사를 하기 때문이다.

<br>

### 3. 변화를 일으키는 함수, 리듀서는 순수 함수여야 한다.

순수함수란? 동일한 인풋일때 언제다 동일한 아웃풋을 배출하는 함수

리듀서함수의 동작 순서

- 리듀서 함수는 이전상태와, 액션 객체를 파라미터로 받는다 .
- 이전의 상태는 절대로 건드리지 않고 변화를 일으킨 새로운 상태 객체를 만들어 반환한다.
- 똑같은 파라미터로 호출된 리듀서 함수는 언제나 똑같은 결과값을 반환한다.

new Date() 함수를 사용하거나, 랜덤 숫자를 생성하거나, 네트워크 요청과 같은 작업은 순수하지 않은 작업이므로 리듀서 함수 바깥에서 처리해줘야한다.
